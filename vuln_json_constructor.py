from vulnerability import Vulnerability

# get a loop going to receive options
while True:
    user_in = input("Input options:\nq - to quit\nn - add new vulnerability\ng - generate json file\nr - remove last vulnerability\n")

    match user_in:
        case 'q':
            quit()
        case 'n':
            print("add new vulnerability")
            name = input("name: ")
            description = input("description: ")
            resources = [x.lstrip() for x in input("resources (separated by comma): ").split(',')]
            categories = [x.lstrip() for x in input("categories (separated by comma; e.g. \"SQL, Web, Database\"): ").split(',')]
            
            vuln = Vulnerability(name, description, resources, categories)
            print(repr(vuln))
        case 'g':
            print("generate json file")
        case 'r':
            print("remove vulnerability")

# have an array to keep track of all the vulnerabilities added

# one of the option should be adding vulnerabilities

# one of the option should be quitting
