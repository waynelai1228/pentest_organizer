import unittest
from model.vuln_dao import VulnerabilityDAO

class VulnDAOTest(unittest.TestCase):
    @classmethod
    def setUpClass(cls):
        cls._vuln_dao = VulnerabilityDAO("test_application.db")

    @classmethod
    def tearDownClass(cls):
        cls._vuln_dao.remove_vuln_by_id(cls._test_uuid)
        print("bye")

    def test_add_vuln_raw_data(self):
        vuln_uuid = VulnDAOTest._vuln_dao.add_vuln("test vulnerability", "a vulnerability added for testing purpose", ['bunch of resources', 'lol'], ['test', 'delete after'])
        self.assertTrue(vuln_uuid is not None)
        VulnDAOTest._test_uuid = vuln_uuid

if __name__ == '__main__':
    unittest.main()
